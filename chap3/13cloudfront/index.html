
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Jacob's AWS Certification Solutions Architect Tutorial">
      
      
        <meta name="author" content="Jacob Xi">
      
      
        <link rel="canonical" href="https://chao-xi.github.io/jxawscsaabook/chap3/13cloudfront/">
      
      <link rel="icon" href="../../images/logo.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.2.5">
    
    
      
        <title>L13 AWS CloudFront - Jacob AWS Certification Solutions Architect Book</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2d9f7617.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
          
          
          <meta name="theme-color" content="#ffa724">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="orange" data-md-color-accent="orange">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#l13-aws-cloudfront" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="Jacob AWS Certification Solutions Architect Book" class="md-header__button md-logo" aria-label="Jacob AWS Certification Solutions Architect Book" data-md-component="logo">
      
  <img src="../../images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Jacob AWS Certification Solutions Architect Book
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              L13 AWS CloudFront
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="清空当前内容" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Chao-Xi/jxawscsaabook.git/" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    jxawscsaabook
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Jacob AWS Certification Solutions Architect Book" class="md-nav__button md-logo" aria-label="Jacob AWS Certification Solutions Architect Book" data-md-component="logo">
      
  <img src="../../images/logo.png" alt="logo">

    </a>
    Jacob AWS Certification Solutions Architect Book
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Chao-Xi/jxawscsaabook.git/" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    jxawscsaabook
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Welcome
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Chap1 Exam-Intro
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Chap1 Exam-Intro" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Chap1 Exam-Intro
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap1/1Exam_Guide/" class="md-nav__link">
        L1 SAA-C02 Exam Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap1/2Learning_path/" class="md-nav__link">
        L2 Associate SAA-C02 Exam Topics
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Chap2 Services Cheat Sheet
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Chap2 Services Cheat Sheet" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Chap2 Services Cheat Sheet
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap2/1best_prac/" class="md-nav__link">
        L1 AWS Best Practices
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap2/2s3_cs/" class="md-nav__link">
        L2 AWS Storage & Content Delivery Cheat Sheet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap2/3IS_cs/" class="md-nav__link">
        L3 AWS Security & Identity Service Cheat Sheet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap2/4Ns_cs/" class="md-nav__link">
        L4 AWS Networking Services Cheat Sheet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap2/5CS_cs/" class="md-nav__link">
        L5 AWS Compute Services Cheat Sheet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap2/6DS_cs/" class="md-nav__link">
        L6 AWS Database Services Cheat Sheet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap2/7AS_cs/" class="md-nav__link">
        L7 AWS Analytics Services Cheat Sheet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap2/8AS_cs/" class="md-nav__link">
        L8 AWS Application Services Cheat Sheet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap2/9MT_cs/" class="md-nav__link">
        L9 AWS Management Tools Cheat Sheet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap2/10EXAM_cs/" class="md-nav__link">
        L10 AWS Certification Exam Cheat Sheet
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Chap3 Networking Exam Topics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Chap3 Networking Exam Topics" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Chap3 Networking Exam Topics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1vpc/" class="md-nav__link">
        L1 AWS Virtual Private Cloud – VPC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../2bastion/" class="md-nav__link">
        L2 AWS Bastion Host
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../3direct_connect/" class="md-nav__link">
        L3 AWS Direct Connect – DX
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../4ELB/" class="md-nav__link">
        L4 AWS Elastic Load Balancer – ELB
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../5ALB/" class="md-nav__link">
        L5 AWS Application Load Balancer – ALB
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../6NLB/" class="md-nav__link">
        L6 AWS Network Load Balancer – NLB
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../7EAN_LB/" class="md-nav__link">
        L7 AWS Classic Load Balancer vs Application Load Balancer vs Network Load Balancer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../8elb_mon/" class="md-nav__link">
        L8 AWS ELB Monitoring
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../9route53/" class="md-nav__link">
        L9 AWS Certification – Route 53 Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../10route53_policy/" class="md-nav__link">
        L10 AWS Route 53 Routing Policy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../11route53_resolver/" class="md-nav__link">
        L11 AWS Route 53 Resolver
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../12api_gateway/" class="md-nav__link">
        L12 AWS API Gateway
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          L13 AWS CloudFront
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        L13 AWS CloudFront
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-cloudfront" class="md-nav__link">
    1 CloudFront
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-cloudfront-benefits" class="md-nav__link">
    2 CloudFront Benefits
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-configuration-content-delivery" class="md-nav__link">
    3 Configuration &amp; Content Delivery
  </a>
  
    <nav class="md-nav" aria-label="3 Configuration &amp; Content Delivery">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#3-1-configuration" class="md-nav__link">
    3-1 Configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-2-content-delivery-to-users" class="md-nav__link">
    3-2 Content delivery to Users
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-delivery-methods" class="md-nav__link">
    4 Delivery Methods
  </a>
  
    <nav class="md-nav" aria-label="4 Delivery Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#4-1-web-distributions" class="md-nav__link">
    4-1 Web distributions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-2-cloudfront-origins" class="md-nav__link">
    4-2 CloudFront Origins
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-cache-behavior-settings" class="md-nav__link">
    5 Cache Behavior Settings
  </a>
  
    <nav class="md-nav" aria-label="5 Cache Behavior Settings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#5-1-path-patterns" class="md-nav__link">
    5-1 Path Patterns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-2-viewer-protocol-policy" class="md-nav__link">
    5-2 Viewer Protocol Policy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-3-https-connection" class="md-nav__link">
    5-3 HTTPS Connection
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-allowed-http-methods" class="md-nav__link">
    6 Allowed HTTP methods
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-field-level-encryption-config" class="md-nav__link">
    7 Field Level Encryption Config
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-cloudfront-edge-caches" class="md-nav__link">
    8 CloudFront Edge Caches
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-object-caching-expiration" class="md-nav__link">
    9 Object Caching &amp; Expiration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-restrict-viewer-access" class="md-nav__link">
    10 Restrict Viewer Access
  </a>
  
    <nav class="md-nav" aria-label="10 Restrict Viewer Access">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#10-1-serving-private-content" class="md-nav__link">
    10-1 Serving Private Content
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-2-signed-urls-vs-signed-cookies" class="md-nav__link">
    10-2 Signed URLs vs Signed Cookies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-3-canned-policy-vs-custom-policy" class="md-nav__link">
    10-3 Canned Policy vs Custom Policy
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-serving-compressed-files" class="md-nav__link">
    11 Serving Compressed Files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-distribution-details" class="md-nav__link">
    12 Distribution Details
  </a>
  
    <nav class="md-nav" aria-label="12 Distribution Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#12-1-price-class" class="md-nav__link">
    12-1 Price Class
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-2-waf-web-acl" class="md-nav__link">
    12-2 WAF Web ACL
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-3-alternate-domain-names-cnames" class="md-nav__link">
    12-3 Alternate Domain Names (CNAMEs)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-4-distribution-state" class="md-nav__link">
    12-4 Distribution State
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#13-geo-restriction-geoblocking" class="md-nav__link">
    13 Geo-Restriction – Geoblocking
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#14-cloudfront-with-s3" class="md-nav__link">
    14 CloudFront with S3
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#15-origin-access-identity" class="md-nav__link">
    15 Origin Access Identity
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#16-working-with-objects" class="md-nav__link">
    16 Working with Objects
  </a>
  
    <nav class="md-nav" aria-label="16 Working with Objects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#16-1-adding-updating-objects" class="md-nav__link">
    16-1 Adding &amp; Updating Objects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-2-removinginvalidating-objects" class="md-nav__link">
    16-2 Removing/Invalidating Objects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-3-partial-requests-range-gets" class="md-nav__link">
    16-3 Partial Requests (Range GETs)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#17-cloudfront-security" class="md-nav__link">
    17 CloudFront Security
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#18-access-logs" class="md-nav__link">
    18 Access Logs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#19-cloudfront-cost" class="md-nav__link">
    19 CloudFront Cost
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../14direct_connect/" class="md-nav__link">
        L14 AWS Direct Connect – DX
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          chap4 AWS Security, Identity & Compliance
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="chap4 AWS Security, Identity & Compliance" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          chap4 AWS Security, Identity & Compliance
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap4/1AWS_IAM/" class="md-nav__link">
        L1 AWS Identity Access Management – IAM(unfinished)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          chap7 AWS Database Services
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="chap7 AWS Database Services" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          chap7 AWS Database Services
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap7/1rds/" class="md-nav__link">
        L1 AWS RDS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap7/2DynamoDB/" class="md-nav__link">
        L2 AWS DynamoDB(unfinished)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Chap10 AWS Migration & Transfer Services
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Chap10 AWS Migration & Transfer Services" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Chap10 AWS Migration & Transfer Services
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap10/1aws_cms/" class="md-nav__link">
        L1 AWS Cloud Migration Services
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap10/2AWS_IE/" class="md-nav__link">
        L2 AWS Import/Export
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap10/3AWS_DTS/" class="md-nav__link">
        L3 AWS Data Transfer Services
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Chap11 AWS Analytics Services
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Chap11 AWS Analytics Services" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Chap11 AWS Analytics Services
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap11/4Elasticsearch/" class="md-nav__link">
        L4 AWS Elasticsearch
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-cloudfront" class="md-nav__link">
    1 CloudFront
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-cloudfront-benefits" class="md-nav__link">
    2 CloudFront Benefits
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-configuration-content-delivery" class="md-nav__link">
    3 Configuration &amp; Content Delivery
  </a>
  
    <nav class="md-nav" aria-label="3 Configuration &amp; Content Delivery">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#3-1-configuration" class="md-nav__link">
    3-1 Configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-2-content-delivery-to-users" class="md-nav__link">
    3-2 Content delivery to Users
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-delivery-methods" class="md-nav__link">
    4 Delivery Methods
  </a>
  
    <nav class="md-nav" aria-label="4 Delivery Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#4-1-web-distributions" class="md-nav__link">
    4-1 Web distributions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-2-cloudfront-origins" class="md-nav__link">
    4-2 CloudFront Origins
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-cache-behavior-settings" class="md-nav__link">
    5 Cache Behavior Settings
  </a>
  
    <nav class="md-nav" aria-label="5 Cache Behavior Settings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#5-1-path-patterns" class="md-nav__link">
    5-1 Path Patterns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-2-viewer-protocol-policy" class="md-nav__link">
    5-2 Viewer Protocol Policy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-3-https-connection" class="md-nav__link">
    5-3 HTTPS Connection
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-allowed-http-methods" class="md-nav__link">
    6 Allowed HTTP methods
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-field-level-encryption-config" class="md-nav__link">
    7 Field Level Encryption Config
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-cloudfront-edge-caches" class="md-nav__link">
    8 CloudFront Edge Caches
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-object-caching-expiration" class="md-nav__link">
    9 Object Caching &amp; Expiration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-restrict-viewer-access" class="md-nav__link">
    10 Restrict Viewer Access
  </a>
  
    <nav class="md-nav" aria-label="10 Restrict Viewer Access">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#10-1-serving-private-content" class="md-nav__link">
    10-1 Serving Private Content
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-2-signed-urls-vs-signed-cookies" class="md-nav__link">
    10-2 Signed URLs vs Signed Cookies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-3-canned-policy-vs-custom-policy" class="md-nav__link">
    10-3 Canned Policy vs Custom Policy
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-serving-compressed-files" class="md-nav__link">
    11 Serving Compressed Files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-distribution-details" class="md-nav__link">
    12 Distribution Details
  </a>
  
    <nav class="md-nav" aria-label="12 Distribution Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#12-1-price-class" class="md-nav__link">
    12-1 Price Class
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-2-waf-web-acl" class="md-nav__link">
    12-2 WAF Web ACL
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-3-alternate-domain-names-cnames" class="md-nav__link">
    12-3 Alternate Domain Names (CNAMEs)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-4-distribution-state" class="md-nav__link">
    12-4 Distribution State
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#13-geo-restriction-geoblocking" class="md-nav__link">
    13 Geo-Restriction – Geoblocking
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#14-cloudfront-with-s3" class="md-nav__link">
    14 CloudFront with S3
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#15-origin-access-identity" class="md-nav__link">
    15 Origin Access Identity
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#16-working-with-objects" class="md-nav__link">
    16 Working with Objects
  </a>
  
    <nav class="md-nav" aria-label="16 Working with Objects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#16-1-adding-updating-objects" class="md-nav__link">
    16-1 Adding &amp; Updating Objects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-2-removinginvalidating-objects" class="md-nav__link">
    16-2 Removing/Invalidating Objects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-3-partial-requests-range-gets" class="md-nav__link">
    16-3 Partial Requests (Range GETs)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#17-cloudfront-security" class="md-nav__link">
    17 CloudFront Security
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#18-access-logs" class="md-nav__link">
    18 Access Logs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#19-cloudfront-cost" class="md-nav__link">
    19 CloudFront Cost
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/Chao-Xi/jxawscsaabook.git/edit/master/docs/chap3/13cloudfront.md" title="编辑此页" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>



<h1 id="l13-aws-cloudfront"><strong>L13 AWS CloudFront</strong></h1>
<h2 id="1-cloudfront"><strong>1 CloudFront</strong></h2>
<ul>
<li>CloudFront is a fully managed, <strong>fast content delivery network (CDN) service that speeds up the distribution of static, dynamic web, or streaming content to end-users</strong>.</li>
<li>CloudFront delivers the content through a <strong>worldwide network of data centers called edge locations or Point of Presence (POP)</strong>.</li>
<li>CloudFront securely delivers data, videos, applications, and APIs to customers globally with low latency, high transfer speeds, all within a developer-friendly environment.</li>
<li>CloudFront gives businesses and web application developers an easy and cost-effective way to distribute content with low latency and high data transfer speeds.</li>
<li><strong>CloudFront speeds up the distribution of the content by routing each user request to the edge location</strong> that can best serve the content thus providing the lowest latency (time delay).</li>
<li>CloudFront dramatically reduces the number of network hops that users’ requests must pass through, which helps improves performance, provide lower latency and higher data transfer rates.</li>
<li>CloudFront is a good choice for the distribution of frequently accessed static content that benefits from edge delivery – like popular website images, videos, media files, or software downloads</li>
</ul>
<h2 id="2-cloudfront-benefits"><strong>2 CloudFront Benefits</strong></h2>
<ul>
<li><strong>CloudFront eliminates the expense and complexity of operating a network of cache server</strong>s in multiple sites across the internet and eliminates the need to over-provision capacity in order to serve potential spikes in traffic.</li>
<li>CloudFront also provides increased reliability and availability because copies of objects are held in multiple edge locations around the world.</li>
<li>CloudFront keeps persistent connections with the origin servers so that those files can be fetched from the origin servers as quickly as possible.</li>
<li>CloudFront also uses techniques such as <strong>collapsing simultaneous viewer requests at an edge location for the same file into a single request to the origin server reducing the load on the origin</strong>.</li>
<li>CloudFront offers the most advanced security capabilities, including field-level encryption and HTTPS support.</li>
<li><strong>CloudFront seamlessly integrates with AWS Shield, AWS Web Application Firewall, and Route 53 to protect against multiple types of attacks including network and application layer DDoS attacks</strong>.</li>
</ul>
<h2 id="3-configuration-content-delivery"><strong>3 Configuration &amp; Content Delivery</strong></h2>
<p><img alt="Alt Image Text" src="../../images/chap3_13_1.png" title="Body image" /></p>
<h3 id="3-1-configuration"><strong>3-1 Configuration</strong></h3>
<ul>
<li><strong>Origin servers need to be configured to get the files for distribution</strong>. An origin server stores the original, definitive version of the objects and <strong>can be an AWS hosted service for e.g. S3, EC2, or an on-premise server</strong></li>
<li>Files or objects can be added/uploaded to the Origin servers with public read permissions or permissions restricted to Origin Access Identity (OAI).</li>
<li>Create a CloudFront distribution, which tells CloudFront which origin servers to get the files from when users request the files</li>
<li>CloudFront sends the distribution configuration to all the edge locations</li>
<li><strong>The website can be used with the CloudFront provided domain name or a custom alternate domain name</strong></li>
<li>An origin server can be configured to limit access protocols, caching behavior, add headers to the files to add TTL or the expiration time</li>
</ul>
<h3 id="3-2-content-delivery-to-users"><strong>3-2 Content delivery to Users</strong></h3>
<ul>
<li>When a user accesses the website, file, or object – the DNS routes the request to the CloudFront edge location that can best serve the user’s request with the lowest latency</li>
<li>CloudFront returns the object immediately if the requested object is present in the cache at the Edge location</li>
<li>If the requested object does not exist in the cache at the edge location, CloudFront requests the object from the origin server and returns it to the user as soon as it starts receiving it</li>
<li><strong>When the object reaches its expiration time, for any new request CloudFront checks with the Origin server for any latest versions, if it has the latest it uses the same object. If the Origin server has the latest version the same is retrieved, served to the user, and cached as well</strong></li>
</ul>
<h2 id="4-delivery-methods"><strong>4 Delivery Methods</strong></h2>
<h3 id="4-1-web-distributions"><strong>4-1 Web distributions</strong></h3>
<ul>
<li>supports both s<strong>tatic and dynamic content for e.g. HTML, CSS, js, images, etc using HTTP or HTTPS</strong>.</li>
<li>supports multimedia content on-demand using progressive download and <strong>Apple HTTP Live Streaming (HLS)</strong>.</li>
<li><strong>supports a live event, such as a meeting, conference</strong>, or concert, in real-time. For live streaming, distribution can be created automatically using an AWS CloudFormation stack.</li>
<li><strong>origin servers can be either an S3 bucket or an HTTP server, for e.g., a web server or an AWS ELB, etc.</strong></li>
</ul>
<h3 id="4-2-cloudfront-origins"><strong>4-2 CloudFront Origins</strong></h3>
<ul>
<li><strong>Each origin is either an S3 bucket, a MediaStore container, a MediaPackage channel, or a custom origin like EC2 instance or an HTTP server</strong></li>
<li>For the S3 bucket, use the bucket URL or the static website endpoint URL, and the files either need to be publicly readable or secured using OAI.</li>
<li><strong>Origin restrict access, for S3 only</strong>, can be configured using Origin Access Identity to prevent direct access to the S3 objects</li>
<li><strong>For the HTTP server as the origin, the domain name of the resource needs to be mapped and files must be publicly readable</strong>.</li>
<li><strong>Distribution can have multiple origins for each bucket with one or more cache behaviors that route requests to each origin</strong>. Path pattern in a cache behavior determines which requests are routed to the origin (S3 bucket) that is associated with that cache behavior</li>
</ul>
<h2 id="5-cache-behavior-settings"><strong>5 Cache Behavior Settings</strong></h2>
<h3 id="5-1-path-patterns"><strong>5-1 Path Patterns</strong></h3>
<ul>
<li>Path Patterns help define which path the Cache behavior would apply to.</li>
<li>A default (*) pattern is created and multiple cache distributions can be added with patterns to take priority over the default path</li>
</ul>
<h3 id="5-2-viewer-protocol-policy"><strong>5-2 Viewer Protocol Policy</strong></h3>
<ul>
<li>Viewer Protocol policy can be configured to define the allowed access protocol.</li>
<li>Between CloudFront &amp; Viewers, cache distribution can be configured to either allow<ul>
<li><strong>HTTPS only</strong> – supports HTTPS only</li>
<li><strong>HTTP and HTTPS</strong> – supports both</li>
<li><strong>HTTP redirected to HTTPS</strong> – HTTP is automatically redirected to HTTPS</li>
</ul>
</li>
</ul>
<h3 id="5-3-https-connection"><strong>5-3 HTTPS Connection</strong></h3>
<ul>
<li>Between CloudFront &amp; Origin, cache distribution can be configured to require that CloudFront fetches objects from the origin <strong>by using HTTPS or CloudFront uses the protocol that the viewer used to request the objects</strong>.</li>
<li><strong>For S3 as origin</strong>,<ul>
<li>For website, the protocol has to be HTTP as HTTPS is not supported</li>
<li>For S3 bucket, the default Origin protocol policy is Match Viewer and cannot be changed. <strong>So When CloudFront is configured to require HTTPS between the viewer and CloudFront, it automatically uses HTTPS to communicate with S3</strong>.</li>
</ul>
</li>
<li>
<p>CloudFront can also be configured to work with HTTPS for alternate domain names by using:-</p>
<ul>
<li>Serving HTTPS Requests Using Dedicated IP Addresses<ul>
<li>CloudFront associates the alternate domain name with a dedicated IP address, and the certificate is associated with the IP address. when a request is received from a DNS server for the IP address,</li>
<li>CloudFront uses the IP address to identify the distribution and the SSL/TLS certificate to return to the viewer</li>
<li>This method works for every HTTPS request, regardless of the browser or other viewer that the user is using.
<strong>* Additional monthly charge (of about $600/month) is incurred for using a dedicated IP address</strong></li>
</ul>
</li>
<li><strong>Serving HTTPS Requests Using SNI</strong><ul>
<li>SNI custom SSL relies on the SNI extension of the TLS protocol, which allows multiple domains to be served over the same IP address by including the hostname, viewers are trying to connect to</li>
<li>With SNI method, CloudFront associates an IP address with the alternate domain name, but the IP address is not dedicated</li>
<li>CloudFront can’t determine, based on the IP address, which domain the request is for as the IP address is not dedicated</li>
<li>Browsers that support SNI automatically gets the domain name from the request URL &amp; adds it to a new field in the request header.</li>
<li>When CloudFront receives an HTTPS request from a browser that supports SNI, it finds the domain name in the request header and responds to the request with the applicable SSL/TLS certificate.</li>
<li>Viewer and CloudFront perform SSL negotiation, and CloudFront returns the requested content to the viewer.</li>
<li>Older browsers do not support it</li>
<li>SNI Custom SSL is available at no additional cost beyond standard CloudFront data transfer and request fees</li>
</ul>
</li>
</ul>
</li>
<li>
<p>For End-to-End HTTPS connections certificate needs to be applied both between the Viewers and CloudFront &amp; CloudFront and Origin, with the following requirements</p>
<ul>
<li><strong>HTTPS between viewers and CloudFront</strong><ul>
<li>Certificate that was issued by a trusted certificate authority (CA) such as <strong>Comodo, DigiCert, or Symantec;</strong></li>
<li>Certificate provided by AWS Certificate Manager (ACM);</li>
<li>Self-signed certificate.</li>
</ul>
</li>
<li><strong>HTTPS between CloudFront and a custom origin</strong><ul>
<li>If the origin is not an ELB load balancer, the certificate must be issued by a trusted CA such as Comodo, DigiCert, or Symantec.</li>
<li>For ELB load balancer, certificate provided by ACM can be used</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="6-allowed-http-methods"><strong>6 Allowed HTTP methods</strong></h2>
<ul>
<li>CloudFront supports GET, HEAD, OPTIONS, PUT, POST, PATCH, DELETE to get, add, update, and delete objects, and to get object headers.<ul>
<li><strong>GET, HEAD</strong> methods to use to get objects, object headers</li>
<li><strong>GET, HEAD, OPTIONS</strong> methods to use to get objects, object headers or retrieve a list of the options supported from the origin</li>
<li><strong>GET, HEAD, OPTIONS, PUT, POST, PATCH, DELETE</strong> operations can also be performed for e.g. submitting data from a web form, which are directly proxied back to the Origin server</li>
</ul>
</li>
<li><strong><em>CloudFront only caches responses to GET and HEAD requests and, optionally, OPTIONS requests. CloudFront does not cache responses to PUT, POST, PATCH, DELETE request methods and these requests are directed to the origin</em></strong>.</li>
<li>PUT, POST HTTP methods also help for accelerated content uploads, as these operations will be sent to the origin e.g. S3 via the CloudFront edge location, improving efficiency, reducing latency, and allowing the application to benefit from the monitored, persistent connections that CloudFront maintains from the edge locations to the origin servers.</li>
</ul>
<h2 id="7-field-level-encryption-config"><strong>7 Field Level Encryption Config</strong></h2>
<ul>
<li><strong>CloudFront can enforce secure end-to-end connections to origin servers by using HTTPS</strong>.</li>
<li>Field-level encryption adds an additional layer of security that helps protect specific data throughout system processing so that only certain applications can see it.</li>
</ul>
<h2 id="8-cloudfront-edge-caches"><strong>8 CloudFront Edge Caches</strong></h2>
<p><strong>Control the cache max-age</strong></p>
<ul>
<li>To increase the cache hit ratio, the origin can be configured to add a <code>Cache-Control: max-age</code>  directive to the objects.</li>
<li>Longer the interval less frequently it would be retrieved from the origin</li>
</ul>
<p><strong>Caching Based on Query String Parameters</strong></p>
<ul>
<li>
<p>CloudFront can be configured to cache based on the query parameters</p>
<ul>
<li><strong>None (Improves Caching)</strong> – if the origin returns the same version of an object regardless of the values of query string parameters.</li>
<li><strong>Forward all, cache based on whitelist</strong> – if the origin server returns different versions of the objects based on one or more query string parameters. Then specify the parameters that you want CloudFront to use as a basis for caching in the Query String Whitelist field.</li>
<li><strong>Forward all, cache based on all</strong> – if the origin server returns different versions of the objects for all query string parameters.</li>
</ul>
</li>
<li>
<p><strong>Caching performance can be improved by</strong></p>
<ul>
<li>Configure CloudFront to forward only the query strings for which the origin will return unique objects.</li>
<li>Using the same case for the parameters’ values for e.g. parameter value A or a, <strong>CloudFront would cache the same request twice even if the response or object returned is identical</strong></li>
<li>Using the same parameter order for e.g. for <strong>request a=x&amp;b=y and b=y&amp;a=x, CloudFront would cache the same request twice even though the response or object returned is identical</strong></li>
</ul>
</li>
</ul>
<p><strong>Caching Based on Cookie Values</strong></p>
<ul>
<li>CloudFront can be configured to cache based on cookie values.</li>
<li>By default, it doesn’t consider cookies while caching on edge locations</li>
<li>Caching performance can be improved by<ul>
<li>Configure CloudFront to forward only specified cookies instead of forwarding all cookies for e.g. <em>if the request has 2 cookies with 3 possible values, CloudFront would cache all possible combinations even if the response takes into account a single cookie</em></li>
<li>Cookie names and values are both case sensitive so better to stick with the same case</li>
<li>Create separate cache behaviors for static and dynamic content, and configure CloudFront to forward cookies to the origin only for dynamic content for e.g. <strong><em>for CSS files, the cookies do not make sense as the object does not change with the cookie value</em></strong></li>
<li>If possible, create separate cache behaviors for dynamic content for which cookie values are unique for each user (such as a user ID) and dynamic content that varies based on a smaller number of unique values reducing the number of combinations</li>
</ul>
</li>
</ul>
<p><strong>Caching Based on Request Headers</strong></p>
<ul>
<li>CloudFront can be configured to cache based on request headers</li>
<li>By default, CloudFront doesn’t consider headers when caching the objects in edge locations.</li>
<li>CloudFront configured to cache based on request headers, does not change the headers that CloudFront forwards, only whether CloudFront caches objects based on the header values.</li>
<li>Caching performance can be improved by<ul>
<li>Configure CloudFront to forward and cache based only on specified headers instead of forwarding and caching based on all headers.</li>
<li>Try to avoid caching based on request headers that have large numbers of unique values.</li>
<li>CloudFront is configured to forward all headers to the origin, CloudFront doesn’t cache the objects associated with this cache behavior. Instead, it sends every request to the origin</li>
<li>CloudFront caches based on header values, it doesn’t consider the case of the header name but considers the case of the header value</li>
</ul>
</li>
</ul>
<h2 id="9-object-caching-expiration"><strong>9 Object Caching &amp; Expiration</strong></h2>
<ul>
<li><strong>Object expiration determines how long the objects stay in a CloudFront cache before it fetches it again from Origin</strong></li>
<li>Low expiration time helps serve content that changes frequently and high expiration time helps improve performance and reduce the origin load.</li>
<li><strong>By default, each object automatically expires after 24 hours</strong></li>
<li>After expiration time, CloudFront checks if it still has the latest version<ul>
<li>If the cache already has the latest version, the origin returns a 304 status code (Not Modified).</li>
<li>If the CloudFront cache does not have the latest version, the origin returns a 200 status code (OK), and the latest version of the object</li>
</ul>
</li>
<li>If an object in an edge location isn’t frequently requested, CloudFront might evict the object, <strong>remove the object before its expiration date, to make room for objects that have been requested more recently.</strong></li>
<li>For Web distributions, the default behavior can be changed by<ul>
<li>for the entire path pattern, cache behavior can be configured <strong>by the setting Minimum TTL, Maximum TTL, and Default TTL values</strong></li>
<li>for individual objects, the origin can be configured to add a <strong>Cache-Control max-age or Cache-Control s-maxage directive, or an Expires header field to the object</strong>.</li>
<li>AWS recommends using <strong>Cache-Control max-age</strong> directive over <strong>Expires</strong> header to control object caching behavior</li>
<li>CloudFront uses only the value of Cache-Control max-age , if both the Cache-Control max-age directive and Expires header is specified</li>
<li>HTTP Cache-Control or Pragma header fields in a GET request from a viewer can’t be used to force CloudFront to go back to the origin server for the object</li>
<li>By default, <strong>when the origin returns an HTTP 4xx or 5xx status code, CloudFront caches these error responses for five minutes and then submits the next request for the object to the origin to see whether the requested object is available and the problem has been resolved</strong></li>
</ul>
</li>
</ul>
<h2 id="10-restrict-viewer-access"><strong>10 Restrict Viewer Access</strong></h2>
<h3 id="10-1-serving-private-content"><strong>10-1 Serving Private Content</strong></h3>
<ul>
<li>
<p><strong>To securely serve private content using CloudFront</strong></p>
<ul>
<li>Require the users to access the private content by using special CloudFront signed URLs or signed cookies with following restrictions<ul>
<li>an end date and time, after which the URL is no longer valid</li>
<li>start date time, when the URL becomes valid</li>
<li>ip address or range of addresses to access the URLs</li>
</ul>
</li>
<li>Require that users access the S3 content only using CloudFront URLs, not S3 URLs. Requiring CloudFront URLs isn’t required, but recommended to prevent users from bypassing the restrictions specified in signed URLs or signed cookies.</li>
</ul>
</li>
<li>
<p>Signed URLs or Signed Cookies can used with CloudFront using HTTP server as an origin. It requires the content to be publicly accessible and care should be taken to not share the direct URL of the content</p>
</li>
<li>
<p>Restriction for Origin can be applied by</p>
<ul>
<li>For S3, using Origin Access Identity to grant only CloudFront access using Bucket policies or Object ACL, to the content and removing any other access permissions</li>
<li>For HTTP server, custom header can be added by CloudFront which can be used at Origin to verify the request has come from CloudFront</li>
</ul>
</li>
<li>
<p><strong>Trusted Signer</strong></p>
</li>
<li>
<p><strong>To create signed URLs or signed cookies, at least one AWS account (trusted signer) is needed that has an active CloudFront key pair</strong></p>
</li>
<li>Once AWS account is added as <strong>trusted signer</strong> to the distribution, CloudFront starts to require that users <strong>use signed URLs or signed cookies to access the objects</strong>.</li>
<li>Private key from the trusted signer’s key pair to sign a portion of the URL or the cookie. When someone requests a restricted object, CloudFront compares the signed portion of the URL or cookie with the unsigned portion to verify that the URL or cookie hasn’t been tampered with. <strong>CloudFront also validates the URL or cookie is valid for e.g, that the expiration date and time hasn’t passed.</strong></li>
<li>Each Trusted signer AWS accounts used to create CloudFront signed URLs or signed cookies must have its own active CloudFront key pair, which should be frequently rotated</li>
<li><strong>A maximum of 5 trusted signers can be assigned for each cache behavior or RTMP distribution</strong></li>
</ul>
<h3 id="10-2-signed-urls-vs-signed-cookies"><strong>10-2 Signed URLs vs Signed Cookies</strong></h3>
<ul>
<li><strong>CloudFront signed URLs and signed cookies help to secure the content and provide control to decide who can access the content.</strong></li>
<li>
<p><strong>Use signed URLs in the following cases:</strong></p>
<ul>
<li>to restrict access to individual files, for e.g., an installation download for the application.</li>
<li>users using a client, for e.g. a <em>custom HTTP client, that doesn’t support cookies</em></li>
</ul>
</li>
<li>
<p><strong>Use signed cookies in the following cases</strong>:</p>
<ul>
<li><em>provide access to multiple restricted files, for e.g., all of the video files in HLS format or all of the files in the subscribers’ area of a website.</em></li>
<li>don’t want to change the current URLs.</li>
</ul>
</li>
<li>
<p>Signed URLs take precedence over signed cookies, if both signed URLs and signed cookies are used to control access to the same files and a viewer uses a signed URL to request a file, CloudFront determines whether to return the file to the viewer based only on the signed URL.</p>
</li>
</ul>
<h3 id="10-3-canned-policy-vs-custom-policy"><strong>10-3 Canned Policy vs Custom Policy</strong></h3>
<ul>
<li><strong>Canned policy or a custom policy is a policy statement, used by the Signed URLs, helps define the restrictions for e.g. <em>expiration date and time</em></strong></li>
</ul>
<p><img alt="Alt Image Text" src="../../images/chap3_13_2.png" title="Body image" /></p>
<ul>
<li>CloudFront validates the expiration time at the start of the event.
If user is downloading a large object, and the url expires the download would still continue and the same for RTMP distribution.</li>
<li>However, if the user is using range GET requests, or while streaming video skips to another position which might trigger an other event, the request would fail.</li>
</ul>
<h2 id="11-serving-compressed-files"><strong>11 Serving Compressed Files</strong></h2>
<ul>
<li>CloudFront can be configured to automatically compress files of certain types and serve the compressed files when viewer requests include <strong>Accept-Encodin</strong>g in the request header</li>
<li>Compressing content, downloads are faster because the files are smaller as well as less expensive as the cost of CloudFront data transfer is based on the <strong>total amount of data served</strong>.</li>
<li>CloudFront can compress objects using the <strong>Gzip and Brotli compression formats</strong>.</li>
<li>If serving from a custom origin, it can be used to<ul>
<li>configure to compress files with or without CloudFront compression</li>
<li>compress file types that CloudFront doesn’t compress.</li>
</ul>
</li>
<li>If the origin returns a compressed file, CloudFront detects compression by the <strong>Content-Encoding header</strong> value and doesn’t compress the file again.</li>
</ul>
<p><strong>CloudFront serves content using compression as below</strong></p>
<ul>
<li>CloudFront distribution is created and configured to compress content.</li>
<li>A viewer requests a compressed file by adding the <strong>Accept-Encoding header with includes gzip, br, or both to the request</strong>.</li>
<li>At the edge location, CloudFront checks the cache for a compressed version of the file that is referenced in the request.</li>
<li>If the compressed file is already in the cache, CloudFront returns the file to the viewer and skips the remaining steps.</li>
<li>If the compressed file is not in the cache, CloudFront forwards the request to the origin server (S3 bucket or a custom origin)</li>
<li>Even if CloudFront has an uncompressed version of the file in the cache, it still forwards a request to the origin.</li>
<li>Origin server returns an uncompressed version of the requested file</li>
<li>CloudFront determines whether the file is compressible:<ul>
<li>file must be of a type that CloudFront compresses.</li>
<li>file size must be between 1,000 and 10,000,000 bytes.</li>
<li>response must include a <strong>Content-Length</strong> header to determine the size within valid compression limits. If the Content-Length header is missing, CloudFront won’t compress the file.</li>
<li>value of the <strong>Content-Encoding header</strong> on the file must not be gzip i.e. the origin has already compressed the file.</li>
<li>the response should have a body</li>
<li>response HTTP status code should be 200, 403, or 404</li>
</ul>
</li>
<li>If the file is compressible, CloudFront compresses it, returns the compressed file to the viewer, and adds it to the cache.</li>
<li>The viewer uncompresses the file.</li>
</ul>
<h2 id="12-distribution-details"><strong>12 Distribution Details</strong></h2>
<h3 id="12-1-price-class"><strong>12-1 Price Class</strong></h3>
<ul>
<li>CloudFront has edge locations all over the world and as <strong>cost for each edge location varies and the price charged for serving the requests also varies</strong></li>
<li>
<p>CloudFront edge locations are grouped into geographic regions, and regions have been grouped into price classes</p>
<ul>
<li><strong>Price Class – includes all the regions</strong></li>
<li>Price Class 200 – Includes All regions except South America and Australia and New Zealand.</li>
<li>Price Class 100 – A third price class includes only the least-expensive regions (North America and Europe regions)</li>
</ul>
</li>
<li>
<p>Price class can be selected to lower the cost but this would come only at the expense of performance (higher latency), as CloudFront would serve requests only from the selected price class edge locations</p>
</li>
<li>CloudFront may, sometimes, service requests from a region not included within the price class, however, you would be charged the rate for the least-expensive region in your selected price class</li>
</ul>
<h3 id="12-2-waf-web-acl"><strong>12-2 WAF Web ACL</strong></h3>
<p>AWS WAF can be used to allow or block requests based on specified criteria, choose the web ACL to associate with this distribution.</p>
<h3 id="12-3-alternate-domain-names-cnames"><strong>12-3 Alternate Domain Names (CNAMEs)</strong></h3>
<ul>
<li>CloudFront by default assigns a domain name for the distribution for e.g. <code>d111111abcdef8.cloudfront.net</code></li>
<li>An alternate domain name, also known as a CNAME, can be used to use own custom domain name for links to objects</li>
<li>CloudFront supports <code>*</code> wildcard at the beginning of a domain name instead of specifying subdomains individually.</li>
<li>However, a wildcard cannot replace part of a subdomain name for e.g. <code>*domain.example.com</code>, or cannot replace a subdomain in the middle of a domain name for e.g. <code>subdomain.*.example.com.</code></li>
</ul>
<h3 id="12-4-distribution-state"><strong>12-4 Distribution State</strong></h3>
<p>Distribution state indicates whether you want the distribution to be enabled or disabled once it’s deployed.</p>
<h2 id="13-geo-restriction-geoblocking"><strong>13 Geo-Restriction – Geoblocking</strong></h2>
<ul>
<li>Geo restriction can help allow or prevent users in selected countries from accessing the content,</li>
<li>CloudFront distribution can be configured either to allow users in<ul>
<li><strong>whitelist of specified countries to access the content</strong> or to</li>
<li><strong>deny users in a blacklist of specified countries to access the content</strong></li>
</ul>
</li>
<li>Geo restriction can be used to restrict access to all of the files that are</li>
<li>associated with distribution and to restrict access at the country level</li>
<li>CloudFront responds to a request from a viewer in a restricted country with an HTTP status code 403 (Forbidden)</li>
<li>Use a third-party geolocation service, if access is to be restricted to a subset of the files that are associated with a distribution or to restrict access at a finer granularity than the country level.</li>
</ul>
<h2 id="14-cloudfront-with-s3"><strong>14 CloudFront with S3</strong></h2>
<ul>
<li>CloudFront can be used to distribute the content from an S3 bucket</li>
<li>For an RTMP distribution, S3 bucket is the only supported origin and custom origins cannot be used</li>
<li><strong>Using CloudFront over S3 has the following benefits</strong><ul>
<li>can be more cost effective if the objects are frequently accessed as at higher usage, the price for CloudFront data transfer is much lower than the price for S3 data transfer.</li>
<li>downloads are faster with CloudFront than with S3 alone because the objects are stored closer to the users</li>
</ul>
</li>
<li>When using S3 as the origin for a distribution and the bucket is moved to a different region, CloudFront can take up to an hour to update its records to include the change of region when both of the following are true:<ul>
<li>Origin Access Identity (OAI) is used to restrict access to the bucket</li>
<li>Bucket is moved to an S3 region that requires Signature Version 4 for authentication</li>
</ul>
</li>
</ul>
<h2 id="15-origin-access-identity"><strong>15 Origin Access Identity</strong></h2>
<ul>
<li><strong>With S3 as origin, objects in S3 must be granted public read permissions and hence the objects are accessible from both S3 as well as CloudFront</strong></li>
<li>Even though, CloudFront does not expose the underlying S3 url, it can be known to the user if shared directly or used by applications</li>
<li>For using CloudFront signed URLs or signed cookies to provide access to the objects, it would be necessary to prevent users from having direct access to the S3 objects</li>
<li>Users accessing S3 objects directly would<ul>
<li>bypass the controls provided by CloudFront signed URLs or signed cookies, <em>for e.g., control over the date time that a user can no longer access the content and the IP addresses can be used to access content</em></li>
<li>CloudFront access logs are less useful because they’re incomplete.</li>
</ul>
</li>
<li><strong>Origin Access Identity (OAI) can be used to prevent users from directly accessing objects from S3</strong></li>
<li>Origin access identity, which is a special CloudFront user, can be created and associated with the distribution.</li>
<li>S3 bucket/object permissions needs to be configured to only provide access to the Origin Access Identity</li>
<li>When users access the object from CloudFront, it uses the OAI to fetch the content on users behalf, while direct access to the S3 objects is restricted</li>
</ul>
<h2 id="16-working-with-objects"><strong>16 Working with Objects</strong></h2>
<p>CloudFront can be configured to include custom headers or modify existing headers whenever it forwards a request to the origin, to</p>
<ul>
<li>validate the user is not accessing the origin directly, bypassing CDN</li>
<li>identify the CDN from which the request was forwarded, if more than one CloudFront distribution is configured to use the same origin</li>
<li>if users use viewers that don’t support CORS, configure CloudFront to forward the Origin header to the origin. That will cause the origin to return the Access-Control-Allow-Origin header for every request</li>
</ul>
<h3 id="16-1-adding-updating-objects"><strong>16-1 Adding &amp; Updating Objects</strong></h3>
<ul>
<li>Objects just need to be added to the Origin and CloudFront would start distributing them when accessed</li>
<li>Objects served by CloudFront the Origin, can be updated either by<ul>
<li>Overwriting the Original object</li>
<li>Create a different version and updating the links exposed to the user</li>
</ul>
</li>
<li>For updating objects, its recommended to use versioning for e.g. have files or the entire folders with versions, so the the links can be changed when the objects are updated forcing a refresh</li>
<li>With versioning,<ul>
<li>there is no time wait for an object to expire before CloudFront begins to serve a new version of it</li>
<li>there is no difference in consistency in the object served from the edge</li>
<li>no cost involved to pay for object invalidation.</li>
</ul>
</li>
</ul>
<h3 id="16-2-removinginvalidating-objects"><strong>16-2 Removing/Invalidating Objects</strong></h3>
<ul>
<li>Objects, by default, would be removed upon expiry (TTL) and the latest object would be fetched from the Origin</li>
<li>Objects can also be removed from the edge cache before it expires<ul>
<li><strong>File or Object Versioning</strong> to serve a different version of the object that has a different name.</li>
<li><strong>Invalidate the object</strong> from edge caches. For the next request, CloudFront returns to the Origin to fetch the object</li>
</ul>
</li>
</ul>
<p><strong>Object or File Versioning is recommended over Invalidating objects</strong></p>
<ul>
<li>if the objects need to be updated frequently.</li>
<li>enables to control which object a request returns even when the user has a version cached either locally or behind a corporate caching proxy.</li>
<li>makes it easier to analyze the results of object changes as CloudFront access logs include the names of the objects</li>
<li>provides a way to serve different versions to different users.</li>
<li>simplifies rolling forward &amp; back between object revisions.</li>
<li>is less expensive, as no charges for invalidating objects.</li>
<li>for e.g. change header-v1.jpg to header-v2.jpg</li>
</ul>
<p><strong>Invalidating objects from the cache</strong></p>
<ul>
<li>objects in the cache can be invalidated explicitly before they expire to force a refresh</li>
<li>allows to invalidate selected objects</li>
<li>allows to invalidate multiple objects for e.g. <em>objects in a directory or all of the objects whose names begin with the same characters, you can include the * wildcard at the end of the invalidation path.</em></li>
<li>the user might continue to see the old version until it expires from those caches.</li>
<li>A specified number of invalidation paths can be submitted each month for free. Any invalidation requests more than the allotted no. per month, a fee is charged for each submitted invalidation path</li>
<li>The First 1,000 invalidation paths requests submitted per month are free; charges apply for each invalidation path over 1,000 in a month.</li>
<li>Invalidation path can be for a single object for e.g. <em><code>/js/ab.js</code> or for multiple objects for e.g. <code>/js/*</code> and is counted as a single request even if the * wildcard request may invalidate thousands of objects.</em></li>
</ul>
<h3 id="16-3-partial-requests-range-gets"><strong>16-3 Partial Requests (Range GETs)</strong></h3>
<ul>
<li>Partial requests using Range headers in a GET request helps to download the object in smaller units, improving the efficiency of partial downloads and the recovery from partially failed transfers.</li>
<li>For a partial GET range request, CloudFront<ul>
<li>checks the cache in the edge location for the requested range or the entire object and if exists, serves it immediately</li>
<li>if the requested range does not exist, it forwards the request to the origin and may request a larger range than the client requested to optimize performance</li>
<li>if the origin supports range header, it returns the requested object range and CloudFront returns the same to the viewer</li>
<li>if the origin does not support range header, it returns the complete object and CloudFront serves the entire object and caches it for future.</li>
<li>CloudFront uses the cached entire object to serve any future range GET header requests</li>
</ul>
</li>
</ul>
<h2 id="17-cloudfront-security"><strong>17 CloudFront Security</strong></h2>
<ul>
<li><strong>CloudFront provides Encryption in Transit and can be configured to require that viewers use HTTPS to request the files so that connections are encrypted when CloudFront communicates with viewers</strong>.</li>
<li><strong>CloudFront provides Encryption at Rest</strong><ul>
<li>uses SSDs which are encrypted for edge location points of presence (POPs), and encrypted EBS volumes for Regional Edge Caches (RECs).</li>
<li>Function code and configuration are always stored in an encrypted format on the encrypted SSDs on the edge location POPs, and in other storage locations used by CloudFront.</li>
</ul>
</li>
<li><strong>Restricting access to content</strong><ul>
<li>Configure HTTPS connections</li>
<li>Use signed URLs or cookies to restrict access for selected users</li>
<li>Restrict access to content in S3 buckets using origin access identity – OAI, to prevent users from using the direct URL of the file.</li>
<li>Set up field-level encryption for specific content fields</li>
<li>Use AWS WAF web ACLs to create a web access control list (web ACL) to restrict access to your content.</li>
<li>Use geo-restriction, also known as geoblocking, to prevent users in specific geographic locations from accessing content served through a CloudFront distribution.</li>
</ul>
</li>
</ul>
<h2 id="18-access-logs"><strong>18 Access Logs</strong></h2>
<ul>
<li>CloudFront can be configured to create log files that contain detailed information about every user request that CloudFront receives.</li>
<li>Access logs are available for both web and RTMP distributions.</li>
<li>With logging enabled, an S3 bucket can be specified where CloudFront would save the files</li>
<li>CloudFront delivers access logs for a distribution periodically, up to several times an hour</li>
<li>CloudFront usually delivers the log file for that time period to the S3 bucket within an hour of the events that appear in the log. Note, however, that some or all log file entries for a time period can sometimes be delayed by up to 24 hours</li>
</ul>
<h2 id="19-cloudfront-cost"><strong>19 CloudFront Cost</strong></h2>
<p>CloudFront charges are based on actual usage of the service in four areas:</p>
<p><strong>Data Transfer Out to Internet</strong></p>
<ul>
<li>charges are applied for the volume of data transferred out of the CloudFront edge locations, measured in GB</li>
<li>Data transfer out from AWS origin (e.g., S3, EC2, etc.) to CloudFront are no longer charged. This applies to data transfer from all AWS regions to all global CloudFront edge locations</li>
</ul>
<p><strong>HTTP/HTTPS Requests</strong></p>
<ul>
<li>number of HTTP/HTTPS requests made for the content</li>
</ul>
<p><strong>Invalidation Requests</strong></p>
<ul>
<li>per path in the invalidation request</li>
<li>A path listed in the invalidation request represents the URL (or multiple URLs if the path contains a wildcard character) of the object you want to invalidate from the CloudFront cache</li>
</ul>
<p><strong>Dedicated IP Custom SSL certificates associated with a CloudFront distribution</strong></p>
<p>$600 per month for each custom SSL certificate associated with one or more CloudFront distributions using the Dedicated IP version of custom SSL certificate support, pro-rated by the hour</p>
<ol>
<li>
<p>Your company Is moving towards tracking web page users with a small tracking Image loaded on each page Currently you are serving this image out of US-East, but are starting to get concerned about the time It takes to load the image for users on the west coast. What are the two best ways to speed up serving this image? Choose 2 answers</p>
<ul>
<li><strong>Use Route 53’s Latency Based Routing and serve the image out of US-West-2 as well as US-East-1</strong></li>
<li><strong>Serve the image out through CloudFront</strong></li>
<li>Serve the image out of S3 so that it isn’t being served oft of your web application tier</li>
<li>Use EBS PIOPs to serve the image faster out of your EC2 instances</li>
</ul>
</li>
<li>
<p>You deployed your company website using Elastic Beanstalk and you enabled log file rotation to S3. An Elastic Map Reduce job is periodically analyzing the logs on S3 to build a usage dashboard that you share with your CIO. You recently improved overall performance of the website using Cloud Front for dynamic content delivery and your website as the origin. After this architectural change, the usage dashboard shows that the traffic on your website dropped by an order of magnitude. How do you fix your usage dashboard’? [PROFESSIONAL]</p>
<ul>
<li><strong>Enable CloudFront to deliver access logs to S3 and use them as input of the Elastic Map Reduce job</strong></li>
<li>Turn on Cloud Trail and use trail log tiles on S3 as input of the Elastic Map Reduce job</li>
<li>Change your log collection process to use Cloud Watch ELB metrics as input of the Elastic Map Reduce job</li>
<li>Use Elastic Beanstalk “Rebuild Environment” option to update log delivery to the Elastic Map Reduce job.</li>
<li>Use Elastic Beanstalk ‘Restart App server(s)” option to update log delivery to the Elastic Map Reduce job.</li>
</ul>
</li>
<li>
<p>An AWS customer runs a public blogging website. The site users upload two million blog entries a month. The average blog entry size is 200 KB. The access rate to blog entries drops to negligible 6 months after publication and users rarely access a blog entry 1 year after publication. Additionally, blog entries have a high update rate during the first 3 months following publication; this drops to no updates after 6 months. The customer wants to use CloudFront to improve his user’s load times. Which of the following recommendations would you make to the customer? [PROFESSIONAL]</p>
<ul>
<li>Duplicate entries into two different buckets and create two separate CloudFront distributions where S3 access is restricted only to Cloud Front identity</li>
<li>Create a CloudFront distribution with “US &amp; Europe” price class for US/Europe users and a different CloudFront distribution with All Edge Locations for the remaining users.</li>
<li><strong>Create a CloudFront distribution with S3 access restricted only to the CloudFront identity and partition the blog entry’s location in S3 according to the month it was uploaded to be used with CloudFront behaviors</strong></li>
<li>Create a CloudFront distribution with Restrict Viewer Access Forward Query string set to true and minimum TTL of 0.</li>
</ul>
</li>
<li>
<p>Your company has on-premises multi-tier PHP web application, which recently experienced downtime due to a large burst in web traffic due to a company announcement. Over the coming days, you are expecting similar announcements to drive similar unpredictable bursts, and are looking to find ways to quickly improve your infrastructures ability to handle unexpected increases in traffic. The application currently consists of 2 tiers a web tier, which consists of a load balancer, and several Linux Apache web servers as well as a database tier which hosts a Linux server hosting a MySQL database. Which scenario below will provide full site functionality, while helping to improve the ability of your application in the short timeframe required? [PROFESSIONAL]</p>
<ul>
<li><strong>Offload traffic from on-premises environment Setup a CloudFront distribution and configure CloudFront to cache objects from a custom origin Choose to customize your object cache behavior, and select a TTL that objects should exist in cache.</strong></li>
<li>Migrate to AWS Use VM Import/Export to quickly convert an on-premises web server to an AMI create an Auto Scaling group, which uses the imported AMI to scale the web tier based on incoming traffic Create an RDS read replica and setup replication between the RDS instance and on-premises MySQL server to migrate the database.</li>
<li>Failover environment: Create an S3 bucket and configure it tor website hosting Migrate your DNS to Route53 using zone (lie import and leverage Route53 DNS failover to failover to the S3 hosted website.</li>
<li>Hybrid environment Create an AMI which can be used of launch web serfers in EC2 Create an Auto Scaling group which uses the * AMI to scale the web tier based on incoming traffic Leverage Elastic Load Balancing to balance traffic between on-premises web servers and those hosted in AWS.</li>
</ul>
</li>
<li>
<p>You are building a system to distribute confidential training videos to employees. Using CloudFront, what method could be used to serve content that is stored in S3, but not publically accessible from S3 directly?</p>
<ul>
<li><strong>Create an Origin Access Identity (OAI) for CloudFront and grant access to the objects in your S3 bucket to that OAI.</strong></li>
<li>Add the CloudFront account security group “amazon-cf/amazon-cf-sg” to the appropriate S3 bucket policy.</li>
<li>Create an Identity and Access Management (IAM) User for CloudFront and grant access to the objects in your S3 bucket to that IAM User.</li>
<li>Create a S3 bucket policy that lists the CloudFront distribution ID as the Principal and the target bucket as the Amazon Resource Name (ARN).</li>
</ul>
</li>
<li>
<p>A media production company wants to deliver high-definition raw video for preproduction and dubbing to customer all around the world. They would like to use Amazon CloudFront for their scenario, and they require the ability to limit downloads per customer and video file to a configurable number. A CloudFront download distribution with TTL=0 was already setup to make sure all client HTTP requests hit an authentication backend on Amazon Elastic Compute Cloud (EC2)/Amazon RDS first, which is responsible for restricting the number of downloads. Content is stored in S3 and configured to be accessible only via CloudFront. What else needs to be done to achieve an architecture that meets the requirements? Choose 2 answers [PROFESSIONAL]</p>
<ul>
<li><strong>Enable URL parameter forwarding, let the authentication backend count the number of downloads per customer in RDS, and return the content S3 URL unless the download limit is reached.</strong></li>
<li>Enable CloudFront logging into an S3 bucket, leverage EMR to analyze CloudFront logs to determine the number of downloads per customer, and return the content S3 URL unless the download limit is reached. (CloudFront logs are logged periodically and EMR not being real time, hence not suitable)</li>
<li>Enable URL parameter forwarding, let the authentication backend count the number of downloads per customer in RDS, and invalidate the CloudFront distribution as soon as the download limit is reached. (Distribution are not invalidated but Objects)</li>
<li>Enable CloudFront logging into the S3 bucket, let the authentication backend determine the number of downloads per customer by parsing those logs, and return the content S3 URL unless the download limit is reached. (CloudFront logs are logged periodically and EMR not being real time, hence not suitable)</li>
<li><strong>Configure a list of trusted signers, let the authentication backend count the number of download requests per customer in RDS, and return a dynamically signed URL unless the download limit is reached.</strong></li>
</ul>
</li>
<li>
<p>Your customer is implementing a video on-demand streaming platform on AWS. The requirements are to support for multiple devices such as iOS, Android, and PC as client devices, using a standard client player, using streaming technology (not download) and scalable architecture with cost effectiveness [PROFESSIONAL]</p>
<ul>
<li>Store the video contents to Amazon Simple Storage Service (S3) as an origin server. Configure the Amazon CloudFront distribution with a streaming option to stream the video contents</li>
<li><strong>Store the video contents to Amazon S3 as an origin server. Configure the Amazon CloudFront distribution with a download option to stream the video contents (Refer link)</strong></li>
<li>Launch a streaming server on Amazon Elastic Compute Cloud (EC2) (for example, Adobe Media Server), and store the video contents as an origin server. Configure the Amazon CloudFront distribution with a download option to stream the video contents</li>
<li>Launch a streaming server on Amazon Elastic Compute Cloud (EC2) (for example, Adobe Media Server), and store the video contents as an origin server. Launch and configure the required amount of streaming servers on Amazon EC2 as an edge server to stream the video contents</li>
</ul>
</li>
<li>
<p>You are an architect for a news -sharing mobile application. Anywhere in the world, your users can see local news on of topics they choose. They can post pictures and videos from inside the application. Since the application is being used on a mobile phone, connection stability is required for uploading content, and delivery should be quick. Content is accessed a lot in the first minutes after it has been posted, but is quickly replaced by new content before disappearing. The local nature of the news means that 90 percent of the uploaded content is then read locally (less than a hundred kilometers from where it was posted). What solution will optimize the user experience when users upload and view content (by minimizing page load times and minimizing upload times)? [PROFESSIONAL]</p>
<ul>
<li>Upload and store the content in a central Amazon Simple Storage Service (S3) bucket, and use an Amazon Cloud Front Distribution for content delivery.</li>
<li>Upload and store the content in an Amazon Simple Storage Service (S3) bucket in the region closest to the user, and use multiple Amazon Cloud Front distributions for content delivery.</li>
<li>Upload the content to an Amazon Elastic Compute Cloud (EC2) instance in the region closest to the user, send the content to a central Amazon Simple Storage Service (S3) bucket, and use an Amazon Cloud Front distribution for content delivery.</li>
<li><strong>Use an Amazon Cloud Front distribution for uploading the content to a central Amazon Simple Storage Service (S3) bucket and for content delivery</strong>.</li>
</ul>
</li>
<li>
<p>To enable end-to-end HTTPS connections from the user‘s browser to the origin via CloudFront, which of the following options are valid? Choose 2 answers [PROFESSIONAL]</p>
<ul>
<li>Use self signed certificate in the origin and CloudFront default certificate in CloudFront. (Origin cannot be self signed)</li>
<li>Use the CloudFront default certificate in both origin and CloudFront (CloudFront cert cannot be applied to origin)</li>
<li><strong>Use 3rd-party CA certificate in the origin and CloudFront default certificate in CloudFront</strong></li>
<li><strong>Use 3rd-party CA certificate in both origin and CloudFront</strong></li>
<li>Use a self signed certificate in both the origin and CloudFront (Origin cannot be self signed)</li>
</ul>
</li>
<li>
<p>Your application consists of 10% writes and 90% reads. You currently service all requests through a Route53 Alias Record directed towards an AWS ELB, which sits in front of an EC2 Auto Scaling Group. Your system is getting very expensive when there are large traffic spikes during certain news events, during which many more people request to read similar data all at the same time. What is the simplest and cheapest way to reduce costs and scale with spikes like this? [PROFESSIONAL]</p>
<ul>
<li>Create an S3 bucket and asynchronously replicate common requests responses into S3 objects. When a request comes in for a precomputed response, redirect to AWS S3</li>
<li>Create another ELB and Auto Scaling Group layer mounted on top of the other system, adding a tier to the system. Serve most read requests out of the top layer</li>
<li><strong>Create a CloudFront Distribution and direct Route53 to the Distribution. Use the ELB as an Origin and specify Cache Behaviors to proxy cache requests, which can be served late. (CloudFront can server request from cache and multiple cache behavior can be defined based on rules for a given URL pattern based on file extensions, file names, or any portion of a URL. Each cache behavior can include the CloudFront configuration values: origin server name, viewer connection protocol, minimum expiration period, query string parameters, cookies, and trusted signers for private content.)</strong></li>
<li>Create a Memcached cluster in AWS ElastiCache. Create cache logic to serve requests, which can be served late from the in-memory cache for increased performance.</li>
</ul>
</li>
<li>
<p>You are designing a service that aggregates clickstream data in batch and delivers reports to subscribers via email only once per week. Data is extremely spikey, geographically distributed, high-scale, and unpredictable. How should you design this system?</p>
<ul>
<li>Use a large RedShift cluster to perform the analysis, and a fleet of Lambdas to perform record inserts into the RedShift tables. Lambda will scale rapidly enough for the traffic spikes.</li>
<li><strong>Use a CloudFront distribution with access log delivery to S3. Clicks should be recorded as query string GETs to the distribution. Reports are built and sent by periodically running EMR jobs over the access logs in S3. (CloudFront is a Gigabit-Scale HTTP(S) global request distribution service and works fine with peaks higher than 10 Gbps or 15,000 RPS. It can handle scale, geo-spread, spikes, and unpredictability. Access Logs will contain the GET data and work just fine for batch analysis and email using EMR. Other streaming options are expensive as not required as the need is to batch analyze)</strong></li>
<li>Use API Gateway invoking Lambdas which PutRecords into Kinesis, and EMR running Spark performing GetRecords on Kinesis to scale with spikes. Spark on EMR outputs the analysis to S3, which are sent out via email.</li>
<li>Use AWS Elasticsearch service and EC2 Auto Scaling groups. The Autoscaling groups scale based on click throughput and stream into the Elasticsearch domain, which is also scalable. Use Kibana to generate reports periodicall</li>
</ul>
</li>
<li>
<p>Your website is serving on-demand training videos to your workforce. Videos are uploaded monthly in high resolution MP4 format. Your workforce is distributed globally often on the move and using company-provided tablets that require the HTTP Live Streaming (HLS) protocol to watch a video. Your company has no video transcoding expertise and it required you might need to pay for a consultant. How do you implement the most cost-efficient architecture without compromising high availability and quality of video delivery? [PROFESSIONAL]</p>
<ul>
<li><strong>Elastic Transcoder to transcode original high-resolution MP4 videos to HLS. S3 to host videos with lifecycle Management to archive original flies to Glacier after a few days. CloudFront to serve HLS transcoded videos from S3</strong></li>
<li>A video transcoding pipeline running on EC2 using SQS to distribute tasks and Auto Scaling to adjust the number or nodes depending on the length of the queue S3 to host videos with Lifecycle Management to archive all files to Glacier after a few days CloudFront to serve HLS transcoding videos from Glacier</li>
<li>Elastic Transcoder to transcode original high-resolution MP4 videos to HLS EBS volumes to host videos and EBS snapshots to incrementally backup original rues after a few days. CloudFront to serve HLS transcoded videos from EC2.</li>
<li>A video transcoding pipeline running on EC2 using SQS to distribute tasks and Auto Scaling to adjust the number of nodes depending on the length of the queue. EBS volumes to host videos and EBS snapshots to incrementally backup original files after a few days. CloudFront to serve HLS transcoded videos from EC2</li>
</ul>
</li>
</ol>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="页脚">
      
        
        <a href="../12api_gateway/" class="md-footer__link md-footer__link--prev" aria-label="上一页: L12 AWS API Gateway" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                上一页
              </span>
              L12 AWS API Gateway
            </div>
          </div>
        </a>
      
      
        
        <a href="../14direct_connect/" class="md-footer__link md-footer__link--next" aria-label="下一页: L14 AWS Direct Connect – DX" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                下一页
              </span>
              L14 AWS Direct Connect – DX
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2021-9999 Jacob Xi
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "\u590d\u5236", "clipboard.copied": "\u5df2\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.term.missing": "\u7f3a\u5c11", "select.version.title": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "search": "../../assets/javascripts/workers/search.bd0b6b67.min.js"}</script>
    
    
      <script src="../../assets/javascripts/bundle.467223ff.min.js"></script>
      
    
  </body>
</html>